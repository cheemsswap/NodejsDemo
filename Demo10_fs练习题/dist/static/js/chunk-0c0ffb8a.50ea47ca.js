(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c0ffb8a"],{"109b":function(e,t,a){},"1d33":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tradeark-container"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addTradeMark}},[e._v("添加")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"tmName",label:"品牌名称","max-width":"400",align:"center"}}),a("el-table-column",{attrs:{label:"品牌LOGO","max-width":"400",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"100px",height:"50px"},attrs:{src:e.row.logoUrl?e.row.logoUrl:"/static/default.jpg",lazy:""}})]}}])}),a("el-table-column",{attrs:{prop:"address",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.updateTradeMark(t.row)}}},[e._v(" "+e._s(e.innerWidth>660?"修改":"")+" ")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.removeTradeMark(t.row)}}},[e._v(" "+e._s(e.innerWidth>660?"删除":"")+" ")])]}}])})],1),a("el-pagination",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"current-page":e.currentPageData.currentPage,"page-sizes":[3,5,10,20],"page-size":e.currentPageData.pageSize,layout:"total, prev, pager, next,->,jumper,sizes ",total:e.currentPageData.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),a("el-dialog",{attrs:{title:e.form.title,visible:e.form.dialogFormVisible},on:{"update:visible":function(t){return e.$set(e.form,"dialogFormVisible",t)}}},[a("el-form",{ref:"Form",attrs:{model:e.form,rules:e.FormRules}},[a("el-form-item",{attrs:{label:"序号","label-width":e.form.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),a("el-form-item",{attrs:{prop:"tmName",label:"品牌名称","label-width":e.form.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.tmName,callback:function(t){e.$set(e.form,"tmName",t)},expression:"form.tmName"}})],1),a("el-form-item",{attrs:{prop:"imageUrl",label:"Logo","label-width":e.form.formLabelWidth}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.form.action,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.form.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.clearTradeMark}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveTradeMark}},[e._v("确 定")])],1)],1)],1)},i=[],o=a("5530"),n=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),{name:"tradeMark",data:function(){var e=function(e,t,a){t&&t.length>0&&t.length<12?a():a(new Error("品牌名称介于1~12个字符"))},t=function(e,t,a){t?a():a(new Error("请上传有效图片"))};return{innerWidth:this.getInnerWidth(),tableData:[],currentPageData:{currentPage:parseInt(this.$route.query.page)||1,pageSize:parseInt(this.$route.query.size)||3,total:0},loading:!0,form:{dialogFormVisible:!1,formLabelWidth:"100px",title:"",id:"",tmName:"",action:"/prod-api/admin/product/fileUpload",imageUrl:""},FormRules:{tmName:[{required:!0,trigger:"change",validator:e}],imageUrl:[{required:!0,trigger:"change",validator:t}]}}},mounted:function(){var e=this;window.onresize=function(){if(!e.timer){e.timer=!0;var t=e;setTimeout((function(){t.innerWidth=t.getInnerWidth(),t.timer=!1}),20)}},this.getData()},destroyed:function(){window.onresize=null},methods:{getInnerWidth:function(){return window.innerWidth},handleCurrentChange:function(e){this.$router.push({query:Object(o["a"])(Object(o["a"])({},this.$route.query),{},{page:e})}),this.currentPageData.currentPage=e,this.getData()},handleSizeChange:function(e){this.$router.push({query:{page:1,size:e}}),this.currentPageData.currentPage=1,this.currentPageData.pageSize=e,this.getData()},getData:function(){var e=this;this.loading=!0,this.$store.dispatch("trademark/getProductBaseTrademarkList",{page:this.currentPageData.currentPage,limit:this.currentPageData.pageSize}).then((function(){var t=e.$store.getters.currentpagedata,a=t.records,r=t.total;e.tableData=a,e.currentPageData.total=r,e.loading=!1})).catch((function(){e.loading=!1}))},addTradeMark:function(){this.$refs.Form&&this.$refs.Form.resetFields(),this.form=Object(o["a"])(Object(o["a"])({},this.form),{},{title:"新增品牌",dialogFormVisible:!0,id:"",imageUrl:"",tmName:""})},updateTradeMark:function(e){var t=e.id,a=e.logoUrl,r=e.tmName;this.$refs.Form&&this.$refs.Form.resetFields(),this.form=Object(o["a"])(Object(o["a"])({},this.form),{},{title:"修改品牌",dialogFormVisible:!0,id:t,imageUrl:a,tmName:r})},removeTradeMark:function(e){var t=this,a=e.id,r=e.tmName;this.$confirm('此操作将永久删除"'.concat(r,'"品牌信息, 是否继续?'),"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.dispatch("trademark/removeBaseTrademark",{id:a}).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.tableData.length<=1&&t.currentPageData.currentPage>=2&&(t.currentPageData.currentPage-=1),t.getData()})).catch((function(e){t.$message({message:"删除失败",type:"error"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},saveTradeMark:function(){var e=this;this.$refs.Form.validate((function(t){t&&(""!=e.form.id?e.$store.dispatch("trademark/updateBaseTrademark",{id:e.form.id,tmName:e.form.tmName,logoUrl:e.form.imageUrl||""}).then((function(t){e.clearTradeMark(),e.$message({message:"修改成功",type:"success"}),e.getData()})).catch((function(t){e.$message({message:"修改失败",type:"error"})})):e.$store.dispatch("trademark/addBaseTrademark",{tmName:e.form.tmName,logoUrl:e.form.imageUrl||""}).then((function(t){e.clearTradeMark(),e.$message({message:"添加成功",type:"success"}),e.currentPageData.currentPage=Math.ceil((e.currentPageData.total+1)/e.currentPageData.pageSize),e.getData()})).catch((function(t){e.$message({message:"添加失败",type:"error"})})))}))},clearTradeMark:function(){this.form.dialogFormVisible=!1},handleAvatarSuccess:function(e,t){200==e.code?this.form.imageUrl=e.data:this.form.imageUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/gif"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传图片只能是 JPG 格式!"),a||this.$message.error("上传图片大小不能超过 2MB!"),t&&a}}}),s=n,l=(a("c9ca"),a("2877")),c=Object(l["a"])(s,r,i,!1,null,"0532105a",null);t["default"]=c.exports},c9ca:function(e,t,a){"use strict";a("109b")}}]);