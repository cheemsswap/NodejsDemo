(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-719c8d3c"],{"1b55":function(t,e,a){},"2f01":function(t,e,a){"use strict";a("1b55")},"542f":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"attr-container"},[a("el-card",[a("CategorySelect",{on:{getCategory:t.getCategory}})],1),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("el-button",{attrs:{disabled:!t.isAdd,type:"primary",icon:"el-icon-plus"},on:{click:t.addAttrInfo}},[t._v("添加属性")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.attrInfoList,border:""}},[a("el-table-column",{attrs:{align:"center",prop:"id",label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"attrName",label:"属性名称",width:"180"}}),a("el-table-column",{attrs:{prop:"attrValueList",label:"属性值列表"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.attrValueList,(function(e){return a("el-tag",{key:e.id,staticStyle:{"margin-right":"3px"},attrs:{type:"success"}},[t._v(" "+t._s(e.valueName)+" ")])}))}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"warning",icon:"el-icon-edit"},on:{click:function(a){return t.updateAttrInfo(e.row)}}},[t._v("修改")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(a){return t.deleteAttrInfo(e.row)}}},[t._v("删除")])]}}])})],1)],1),a("el-dialog",{attrs:{title:t.DialogForm.title,visible:t.DialogForm.visible},on:{"update:visible":function(e){return t.$set(t.DialogForm,"visible",e)}}},[a("el-form",{ref:"DialogForm",attrs:{model:t.DialogForm.value,rules:t.DialogFormRules}},[a("el-form-item",{attrs:{label:"属性ID","label-width":t.DialogForm.formLabelWidth}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:t.DialogForm.value.id,callback:function(e){t.$set(t.DialogForm.value,"id",e)},expression:"DialogForm.value.id"}})],1),a("el-form-item",{attrs:{prop:"attrName",label:"属性名称","label-width":t.DialogForm.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.DialogForm.value.attrName,callback:function(e){t.$set(t.DialogForm.value,"attrName",e)},expression:"DialogForm.value.attrName"}})],1),a("el-form-item",{attrs:{prop:"dynamicTags",label:"属性值","label-width":t.DialogForm.formLabelWidth}},[[t._l(t.DialogForm.value.dynamicTags,(function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return t.handleClose(e)}}},[t._v(" "+t._s(e)+" ")])})),t.DialogForm.value.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.DialogForm.value.inputValue,callback:function(e){t.$set(t.DialogForm.value,"inputValue",e)},expression:"DialogForm.value.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Tag")])]],2)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancelAttrInfo}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.saveAttrInfo}},[t._v("保 存")])],1)],1)],1)},o=[],i=a("b85c"),n=a("5530"),l=(a("4de4"),a("d3b7"),a("a434"),{name:"Attr",data:function(){var t=function(t,e,a){e&&e.length>=1&&e.length<=12?a():a(new Error("请输入1~12个字符的属性名称"))},e=function(t,e,a){e.length?a():a(new Error("请添加至少1个属性值"))};return{loading:!1,category1Id:"",category2Id:"",category3Id:"",attrInfoList:[],isAdd:!1,DialogForm:{visible:!1,title:"",formLabelWidth:"120px",value:{id:"",attrName:"",dynamicTags:[],inputVisible:!1,inputValue:""}},DialogFormRules:{attrName:[{required:!0,trigger:"change",validator:t}],dynamicTags:[{required:!0,trigger:"blur",validator:e}]}}},methods:{getCategory:function(t,e,a){var r=this;a?(this.category1Id=t,this.category2Id=e,this.category3Id=a,this.loading=!0,this.$store.dispatch("attr/reqgetattrInfoList",{category1Id:t,category2Id:e,category3Id:a}).then((function(t){r.loading=!1,r.isAdd=!0,r.attrInfoList=t.filter((function(t){return 3==t.categoryLevel}))})).catch((function(t){r.loading=!1,r.$message({message:t,type:"error"})}))):(this.attrInfoList=[],this.isAdd=!1)},addAttrInfo:function(){this.cancelAttrInfo(),this.DialogForm=Object(n["a"])(Object(n["a"])({},this.DialogForm),{},{title:"新增属性",visible:!0})},updateAttrInfo:function(t){var e,a=t.id,r=t.attrName,o=t.attrValueList,l=[],s=Object(i["a"])(o);try{for(s.s();!(e=s.n()).done;){var c=e.value;l.push(c.valueName)}}catch(u){s.e(u)}finally{s.f()}this.DialogForm=Object(n["a"])(Object(n["a"])({},this.DialogForm),{},{title:"修改属性",visible:!0,value:Object(n["a"])(Object(n["a"])({},this.DialogForm.value),{},{id:a,attrName:r,dynamicTags:l})})},deleteAttrInfo:function(t){var e=this,a=t.id;this.$confirm("此操作将永久删除该属性, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,e.$store.dispatch("attr/reqdelattrInfo",{attrId:a}).then((function(t){e.loading=!1,e.$message({type:"success",message:"删除成功"}),e.getCategory(e.category1Id,e.category2Id,e.category3Id)})).catch((function(t){e.loading=!1,e.$message({type:"error",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},cancelAttrInfo:function(){this.DialogForm=Object(n["a"])(Object(n["a"])({},this.DialogForm),{},{visible:!1,value:{id:"",attrName:"",dynamicTags:[],inputVisible:!1,inputValue:""}}),this.$refs.DialogForm&&this.$refs.DialogForm.resetFields()},saveAttrInfo:function(){var t=this;this.$refs.DialogForm.validate((function(e){if(e){var a,r=[],o=Object(i["a"])(t.DialogForm.value.dynamicTags);try{for(o.s();!(a=o.n()).done;){var n=a.value;r.push({valueName:n})}}catch(s){o.e(s)}finally{o.f()}var l={id:t.DialogForm.value.id||void 0,attrName:t.DialogForm.value.attrName,attrValueList:r,categoryId:t.category3Id,categoryLevel:3};t.$store.dispatch("attr/reqsaveattrInfo",l).then((function(e){t.DialogForm.value.id?t.$message({type:"success",message:"修改成功"}):t.$message({type:"success",message:"添加成功"}),t.cancelAttrInfo(),t.getCategory(t.category1Id,t.category2Id,t.category3Id)})).catch((function(e){t.$message({message:e,type:"error"})}))}}))},handleClose:function(t){this.DialogForm.value.dynamicTags.splice(this.DialogForm.value.dynamicTags.indexOf(t),1)},showInput:function(){var t=this;this.DialogForm.value.inputVisible=!0,this.$nextTick((function(e){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var t=this.DialogForm.value.inputValue;t&&-1==this.DialogForm.value.dynamicTags.indexOf(t)&&this.DialogForm.value.dynamicTags.push(t),this.DialogForm.value.inputVisible=!1,this.DialogForm.value.inputValue=""}}}),s=l,c=(a("2f01"),a("2877")),u=Object(c["a"])(s,r,o,!1,null,"5f80d58e",null);e["default"]=u.exports},a434:function(t,e,a){"use strict";var r=a("23e7"),o=a("23cb"),i=a("a691"),n=a("50c4"),l=a("7b0b"),s=a("65f0"),c=a("8418"),u=a("1dde"),d=a("ae40"),f=u("splice"),g=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,v=Math.min,h=9007199254740991,p="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f||!g},{splice:function(t,e){var a,r,u,d,f,g,b=l(this),y=n(b.length),I=o(t,y),D=arguments.length;if(0===D?a=r=0:1===D?(a=0,r=y-I):(a=D-2,r=v(m(i(e),0),y-I)),y+a-r>h)throw TypeError(p);for(u=s(b,r),d=0;d<r;d++)f=I+d,f in b&&c(u,d,b[f]);if(u.length=r,a<r){for(d=I;d<y-r;d++)f=d+r,g=d+a,f in b?b[g]=b[f]:delete b[g];for(d=y;d>y-r+a;d--)delete b[d-1]}else if(a>r)for(d=y-r;d>I;d--)f=d+r-1,g=d+a-1,f in b?b[g]=b[f]:delete b[g];for(d=0;d<a;d++)b[d+I]=arguments[d+2];return b.length=y-r+a,u}})},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("fb6a"),a("b0c0"),a("a630"),a("ac1f"),a("00b4");function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function o(t,e){if(t){if("string"===typeof t)return r(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(t,e):void 0}}function i(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=o(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return l=t.done,t},e:function(t){s=!0,n=t},f:function(){try{l||null==a["return"]||a["return"]()}finally{if(s)throw n}}}}}}]);